<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satellite</title>
    <link rel="shortcut icon" href="https://www.pngall.com/wp-content/uploads/2016/04/Satellite-Download-PNG.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
    <style>
    body {
        background-color:#383A3F;
    }
    canvas {
        background: blue;}
    p {
        color:white;
        font-size:12pt;
        font-family:arial,helvetica;
        padding-left: 20px;
      }

    h1 {
        color:white;
        padding-top: 15px;
        padding-bottom: 15px;
        font-size:36pt;
        font-family:verdana,arial;
        text-decoration:underline;
        text-align:center;
      }
    .btn {
        display: block;
        background:blue;
        color: white;
        padding: 15px 20px;
        margin: 20px 0;
        border-radius: 5px;
        box-shadow: rgba(0,0,0,0.9);
        transition: all 200ms ease-in-out;
        text-decoration: none;
      }

    </style>


</head>
<body>
    <h1>Satellite</h1>
    <div class="row">
        <div class="col-xs-9 col-md-7">     
            {% for entry in entries %}
               <p>{{ entry }}</p>
            {% endfor %}
        </div>
        <div class="col-xs-3 col-md-5">
            <a href="{{number}}/doppler" class="btn">View Doppler Analysis</a>   
        </div>
    </div>
        <canvas id="myChart"></canvas>
        <script>
            const pointImage=new Image(50,50)
            pointImage.src= 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/FP_Satellite_icon.svg/1200px-FP_Satellite_icon.svg.png'
            //https://cdn-icons-png.flaticon.com/512/1679/1679957.png
            
            userLLA=[]
            userLLA.push({x: "{{userlong}}",y: "{{userlat}}"});
            long=[{% for item in longs %}
                "{{ item }}",
                {% endfor %}]

            lat=[{% for item in lats %}
                "{{ item }}",
                {% endfor %}]
                satPos=[];
                for(var j=1; j<long.length; j++) {
                    satPos.push({x: long[j],y: lat[j]});
                }
            wordlLat=[{% for item in worldLa %}
                "{{ item }}",
                {% endfor %}]

            worldLong=[{% for item in worldLo %}
                "{{ item }}",
                {% endfor %}]
                worldPos=[];
                for(var j=0; j<wordlLat.length; j++) {
                    worldPos.push({x: worldLong[j],y: wordlLat[j]});
                }

            Xvis=[{% for item in xvis %}
                "{{ item }}",
                {% endfor %}]

            Yvis=[{% for item in yvis %}
                "{{ item }}",
                {% endfor %}]
                visPos=[];
                for(var j=0; j<wordlLat.length; j++) {
                    visPos.push({x: Xvis[j],y: Yvis[j]});
                }
            const data = {
              datasets: [     
            {
                label: 'User Visibility',
                backgroundColor: 'white',
                borderColor: 'white',
                data: visPos,
                pointRadius:2,
            },        
            {
                label: 'Actual Position',
                backgroundColor: 'black',
                borderColor: 'black',
                data: [{x: long[0],y: lat[0]}],
                pointRadius: 7,
                pointStyle: pointImage
            },
            {
                label: 'Sat Position',
                backgroundColor: 'rgb(250, 32, 32)',
                borderColor: 'rgb(250, 32, 32)',
                data: satPos,
                pointRadius: 2,
              },
              {
                label: 'User Position',
                backgroundColor: 'yellow',
                borderColor: 'yellow',
                data: userLLA,
                pointRadius: 8,
                pointStyle: "rectRot"
              },
              {
                label: 'World',
                backgroundColor: 'rgb(0, 225, 0)',
                borderColor: 'rgb(0, 225, 0)',
                data: worldPos,
                pointRadius: 2,
              }]
            };
          
            const config = {
              type: 'scatter',
              data: data,
              options: {
                plugins: {
                    legend: {
                        labels: {
                            filter: item => {return item.text != "World"},
                            color: "white",
                        }
                    },
                },
                events: [],
                scales: {
                    x: {
                            max : 180,    
                            min : -180,
                            ticks: { color: 'white'},
                            grid: {color: 'white'},
                            title: {text: 'Longitude',color: 'white', display: true, align: 'center', font: {size:15}},
                        },
                    y: {
                            max : 90,    
                            min : -90,
                            ticks: { color: 'white'},
                            grid: {color: 'white'},
                            title: {text: 'Latitude',color: 'white', display: true, align: 'center', font: {size:15}},
                }}
            }};
            const myChart = new Chart(document.getElementById('myChart'),config);
        </script>
    </div>
</body>
</html>